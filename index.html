<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fixed YouTube Thumbnail Engine</title>
    <script src="https://js.puter.com/v2/"></script>
    <style>
        :root { --yt-red: #ff0000; --bg: #0d0d0d; --card: #1a1a1a; --text: #f0f0f0; --accent: #00e676; }
        body { font-family: 'Inter', sans-serif; background: var(--bg); color: var(--text); padding: 15px; }
        .container { max-width: 800px; margin: auto; background: var(--card); border-radius: 20px; padding: 30px; border: 1px solid #333; }
        #loader { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.9); z-index: 1000; flex-direction: column; align-items: center; justify-content: center; }
        .spinner { width: 50px; height: 50px; border: 5px solid #222; border-top: 5px solid var(--yt-red); border-radius: 50%; animation: spin 1s linear infinite; }
        @keyframes spin { to { transform: rotate(360deg); } }
        label { display: block; margin-top: 15px; font-size: 11px; color: #888; text-transform: uppercase; font-weight: bold; }
        input, textarea { width: 100%; padding: 15px; background: #000; border: 1px solid #444; border-radius: 10px; color: #fff; margin-top: 8px; box-sizing: border-box; }
        .btn { background: var(--yt-red); color: #fff; border: none; padding: 18px; width: 100%; border-radius: 12px; font-size: 16px; font-weight: 800; cursor: pointer; margin-top: 20px; }
        .result-area { margin-top: 30px; text-align: center; }
        #thumbnailContainer img { width: 100%; max-width: 640px; border-radius: 12px; border: 3px solid #333; margin-top: 15px; }
        .overlay-text { background: #222; padding: 10px; border-radius: 8px; color: var(--accent); font-weight: bold; display: inline-block; margin-top: 10px; }
    </style>
</head>
<body>

<div id="loader">
    <div class="spinner"></div>
    <p id="loader-status" style="margin-top: 20px; color: #fff;">Initializing Dual Engines...</p>
</div>

<div class="container">
    <h2 style="text-align: center;">Thumbnail Architect (v2.5)</h2>
    
    <label>Target Topic</label>
    <input type="text" id="topic" placeholder="e.g., iPhone 17 Pro Review">

    <label>Competitor Reference URL</label>
    <input type="text" id="refUrl" placeholder="Paste link of high-performing video...">

    <button class="btn" onclick="buildThumbnail()">GENERATE THUMBNAIL</button>

    <div class="result-area">
        <div id="thumbnailContainer"></div>
        <div id="suggestedText" class="overlay-text" style="display:none;"></div>
    </div>
</div>

<script>
    async function buildThumbnail() {
        const topic = document.getElementById('topic').value;
        const refUrl = document.getElementById('refUrl').value;
        const loader = document.getElementById('loader');
        const status = document.getElementById('loader-status');
        const container = document.getElementById('thumbnailContainer');

        if (!topic) return alert("Please enter a topic!");
        loader.style.display = 'flex';
        container.innerHTML = "";

        try {
            // STEP 1: Gemini 3 Pro - Generate the "Click-Bait" Text
            status.innerText = "Gemini 3: Analyzing Viral Text Patterns...";
            const textResponse = await puter.ai.chat(
                `Suggest 3-4 words of bold, clickable text for a YouTube thumbnail about "${topic}". 
                Reference competitor style: ${refUrl}. Output ONLY the words.`, 
                { model: 'gemini-3-pro-preview' }
            );
            const thumbText = textResponse.toString();

            // STEP 2: GPT-5 - Write the Visual Prompt
            status.innerText = "GPT-5: Engineering Hyper-Realistic Visual Prompt...";
            const promptResponse = await puter.ai.chat(
                `Describe a high-contrast, landscape YouTube thumbnail for: "${topic}". 
                No text in the image. High saturation, bokeh background, 8k resolution.`,
                { model: 'gpt-5' }
            );
            const visualPrompt = promptResponse.toString();

            // STEP 3: Puter Image Engine - Generate the File
            status.innerText = "Rendering Landscape Image...";
            const imageElement = await puter.ai.txt2img(visualPrompt, {
                model: 'gpt-image-1.5', // OpenAI's latest image model for Puter
                quality: 'high'
            });

            // Display results
            container.appendChild(imageElement);
            document.getElementById('suggestedText').innerText = "GEMINI TEXT OVERLAY: " + thumbText;
            document.getElementById('suggestedText').style.display = "inline-block";

        } catch (err) {
            console.error(err);
            alert("Error: " + err.message);
        } finally {
            loader.style.display = 'none';
        }
    }
</script>

</body>
</html>
